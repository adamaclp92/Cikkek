/*!
 * Start Bootstrap - SB Admin 2 v4.0.7 (https://startbootstrap.com/template-overviews/sb-admin-2)
 * Copyright 2013-2019 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

//import { ifError } from "assert";

!function(t){"use strict";t("#sidebarToggle, #sidebarToggleTop").on("click",function(o){t("body").toggleClass("sidebar-toggled"),t(".sidebar").toggleClass("toggled"),t(".sidebar").hasClass("toggled")&&t(".sidebar .collapse").collapse("hide")}),t(window).resize(function(){t(window).width()<768&&t(".sidebar .collapse").collapse("hide")}),t("body.fixed-nav .sidebar").on("mousewheel DOMMouseScroll wheel",function(o){if(768<t(window).width()){var e=o.originalEvent,l=e.wheelDelta||-e.detail;this.scrollTop+=30*(l<0?1:-1),o.preventDefault()}}),t(document).on("scroll",function(){100<t(this).scrollTop()?t(".scroll-to-top").fadeIn():t(".scroll-to-top").fadeOut()}),t(document).on("click","a.scroll-to-top",function(o){var e=t(this);t("html, body").stop().animate({scrollTop:t(e.attr("href")).offset().top},1e3,"easeInOutExpo"),o.preventDefault()})}(jQuery);

//Text file reading
    var textArray;
    function readTextFile(file)
    {
        
        var rawFile = new XMLHttpRequest();
        rawFile.open("GET", file, false);
        rawFile.onreadystatechange = function ()
        {
            if(rawFile.readyState === 4)
            {
                if(rawFile.status === 200 || rawFile.status == 0)
                {
                    var allText = rawFile.responseText;
                    textArray = allText.split(/[\n$$$]+/);   
                }
            }
        }
        rawFile.send(null);
    }

 var textCutting =  readTextFile("https://bikerroute.000webhostapp.com/cikkek/szoveg.txt");

//Array uploading
    function ArrayUpload(num, textArray, difference){
        var tmp = num;
        var array = [];
        for(var i = 0; i < textArray.length; i++){
            array[i] = textArray[tmp];
            tmp = tmp+difference;
           
        }
        return array;
    }

    var title = ArrayUpload(3, textArray, 5);
    var content = ArrayUpload(4, textArray, 5);
    var original = ArrayUpload(2, textArray, 5);
    var recommended = ArrayUpload(0, textArray, 5);
    var recommendedSpec = ArrayUpload(1, textArray, 5);

//Pagination
    var current_page = 1;
    var records_per_page = 20;
    
    function prevPage()
    {
        if (current_page > 1) {
            current_page--;
            changePage(current_page);
            ListItems(); 
        }else{
            current_page = Math.floor(title.length / records_per_page / 5);
            changePage(current_page);
            ListItems(); 
        }
    }
    
    function nextPage()
    {
        if (current_page < numPages()-1) {
            current_page++;
            changePage(current_page);
            ListItems(); 
        }else{
            current_page = 1;
            changePage(current_page);
            ListItems(); 
        }
    }

    function firstPage()
    {
            current_page = 1;
            changePage(current_page);
            ListItems(); 
    }

    function lastPage()
    {
        current_page = Math.floor(title.length / records_per_page / 5);
        changePage(current_page);
        ListItems(); 
    }

    function changePage(page)
    {
        var listing_table = document.getElementById("titles");
        var page_span = document.getElementById("page");
    
        // Validate page
        if (page < 1) page = 1;
        if (page > numPages()) page = numPages();
    
        listing_table.innerHTML = "";
    
        for (var i = (page-1) * records_per_page; i < (page * records_per_page); i++) {
            listing_table.innerHTML += '<option id="' + i + '">' + title[i] + '</option>';
            
        }
        page_span.innerHTML = page;
    }
    
    function numPages()
    {
        return Math.ceil(title.length / records_per_page / 5);
    }


window.onload = function() {
    changePage(1);
    this.ListItems();
};

// Slider
var slider = document.getElementById("customRange1");
var output = document.getElementById("sliderOutput");
output.innerHTML = slider.value;
var actualValue = slider.value;
slider.oninput = function() {
  output.innerHTML = this.value;
  actualValue = this.value;
 
}
       

function ListItems() {
    var recommendedSum = 0;
    var recommendedSpecSum = 0;

    document.getElementById("original2").innerHTML ="";
    document.getElementById("original1").innerHTML = "";
    document.getElementById("recommended1").innerHTML ="";
    document.getElementById("recommended2").innerHTML ="";

    var x = titles.selectedIndex +(current_page-1)*20;
    document.getElementById("contents").innerHTML = content[x]; 

    //Original array split
    var originalSplitted = original[x].split("__label__");
    for(var i = 1; i< originalSplitted.length; i++){

        var totallySplitted = originalSplitted[i].split(" ");
    
        document.getElementById("original1").innerHTML  += totallySplitted[0].replace(/@@/g, " ") + "<br>";
        for(var j = 1; j< totallySplitted.length; j++){
            if(totallySplitted[j].includes("geography") || totallySplitted[j].includes("organization") || totallySplitted[j].includes("person"))
                document.getElementById("original2").innerHTML += totallySplitted[j].replace(/@@/g, " ") + "<br>"; 
                 
        }
    }


    //Recommended array split
    var recommendedSplitted = recommended[x].split("__label__");
    for(var i = 1; i< recommendedSplitted.length; i++){
        var totallySplitted = recommendedSplitted[i].split(" ");
        var number = totallySplitted[1];
        if(document.getElementById("customControlAutosizing").checked){
                if(recommendedSum < 3 ){
                    document.getElementById("recommended1").innerHTML  += totallySplitted[0].replace(/@@/g, " ") + " (" + Math.round(number * 1000) / 1000 +")" +  "<br>";
                    recommendedSum++;
                }
                else if(number > actualValue){
                    document.getElementById("recommended1").innerHTML  += totallySplitted[0].replace(/@@/g, " ") + " (" + Math.round(number * 1000) / 1000 +")" +  "<br>";
                    recommendedSum++;
                }
                
        }
        else if(number > actualValue){
            document.getElementById("recommended1").innerHTML  += totallySplitted[0].replace(/@@/g, " ") + " (" + Math.round(number * 1000) / 1000 +")" +  "<br>";
            recommendedSum++;
        }
        
    }

     //RecommendedSpec array split
     var recommendedSpecSplitted = recommendedSpec[x].split("__label__");
     for(var i = 1; i< recommendedSpecSplitted.length; i++){ 
         var totallySplitted = recommendedSpecSplitted[i].split(" ");
         var number = totallySplitted[1];
        
         if(document.getElementById("customControlAutosizing").checked && (totallySplitted[0].includes("geography") || totallySplitted[0].includes("organization") || totallySplitted[0].includes("person"))){
            if(recommendedSpecSum < 3 ){
                document.getElementById("recommended2").innerHTML  += totallySplitted[0].replace(/@@/g, " ") + " (" + Math.round(number * 1000) / 1000 +")" +  "<br>";
                recommendedSpecSum++;
            }
            else if(number > actualValue){
                document.getElementById("recommended2").innerHTML  += totallySplitted[0].replace(/@@/g, " ") + " (" + Math.round(number * 1000) / 1000 +")" +  "<br>";
                recommendedSpecSum++;
            }
            
        }
        else if(number > actualValue && (totallySplitted[0].includes("geography") || totallySplitted[0].includes("organization") || totallySplitted[0].includes("person"))){
        document.getElementById("recommended2").innerHTML  += totallySplitted[0].replace(/@@/g, " ") + " (" + Math.round(number * 1000) / 1000 +")" +  "<br>";
        recommendedSpecSum++;
        }  
    } 
}


